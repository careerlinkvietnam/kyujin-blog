# サイト全体診断マニュアル Ver 1.0
## Claude Codeによる自律実行仕様

---

## 1. 目的

記事生成に先立ち、サイト全体の健康状態を診断し、
**「何を改善すべきか」を数値とロジックで決定する**。

本診断は「トラフィック増」ではなく **「CV（会員登録・応募）増」** を北極星とする。

---

## 2. 実行トリガー

- **定期実行**: 週次（月曜日）
- **手動実行**: ユーザーからの指示時
- **必須条件**: 新規記事作成の前に必ず1回実行

---

## 3. 必須入力データ

### 3.1 Google Search Console データ
以下のCSVファイルを `Google Search Console/` フォルダから読み込む：

| ファイル | 用途 |
|---------|------|
| クエリ.csv | 検索キーワード分析 |
| ページ.csv | ページ別パフォーマンス |
| デバイス.csv | デバイス別分析 |
| 国.csv | 国別分析 |

### 3.2 インデックス情報
- `Googleインデックス登録ページ.csv`

### 3.3 内部データ
- `プロジェクト進捗履歴.md`
- `キーワードリサーチ資料.md`

---

## 4. 診断項目と実行方法

### 4.1 トラフィック構造診断（最重要）

#### 目的
サイトのトラフィックが「転職ビジネス」に貢献しているかを判定する。

#### 実行手順

1. **GSCクエリデータを分類**

```
転職関連キーワード = [
  "転職", "求人", "就職", "採用", "給与", "年収", "ビザ", "労働許可",
  "現地採用", "駐在", "海外就職", "キャリア", "仕事", "働く"
]

非転職関連（観光・生活系）= [
  "郵便番号", "ホテル", "レストラン", "お土産", "スーパー", "観光",
  "カフェ", "マート", "ショッピング", "フォー", "ビール"
]
```

2. **トップ100クエリの分類集計**

| 分類 | クエリ数 | クリック合計 | 割合 |
|------|---------|-------------|------|
| 転職関連 | ? | ? | ?% |
| 非転職関連 | ? | ? | ?% |

3. **健康度判定**

```
IF 転職関連クリック割合 >= 30%:
    トラフィック健康度 = "良好"
ELIF 転職関連クリック割合 >= 10%:
    トラフィック健康度 = "要改善"
ELSE:
    トラフィック健康度 = "危機的" ← 現状はここ
```

#### 出力

```json
{
  "traffic_structure": {
    "diagnosis_date": "2026-01-16",
    "top_100_queries": {
      "career_related": {"count": 3, "clicks": 150, "percentage": 2.5},
      "non_career_related": {"count": 97, "clicks": 5850, "percentage": 97.5}
    },
    "health_status": "危機的",
    "primary_issue": "転職キーワードでのトラフィックがほぼゼロ"
  }
}
```

---

### 4.2 ページ別導線診断

#### 目的
高トラフィックページが転職CVに貢献しているかを判定する。

#### 実行手順

1. **GSCページデータからトップ50を抽出**

2. **各ページを分類**
   - `/blog/` で始まる → ブログ記事
   - `/job/` または `/仕事情報/` を含む → 求人ページ
   - `/thailand/`, `/vietnam/` 等 → 国別ページ

3. **ブログ記事のCTA有無チェック**
   - WordPress REST API で記事本文を取得
   - 以下のパターンを検索：
     - `kyujin.careerlink.asia/jobseeker/register`
     - `kyujin.careerlink.asia/job/`
     - `kyujin.careerlink.asia/thailand/job/`
     - `kyujin.careerlink.asia/vietnam/job/`

4. **導線スコア算出**

```
導線スコア = (CTAあり記事のクリック合計) / (全ブログ記事のクリック合計) × 100
```

#### 出力

```json
{
  "funnel_diagnosis": {
    "top_50_pages": {
      "blog_pages": 40,
      "job_pages": 5,
      "other_pages": 5
    },
    "blog_cta_status": {
      "with_cta": 5,
      "without_cta": 35,
      "cta_coverage": "12.5%"
    },
    "high_traffic_no_cta": [
      {"url": "/blog/ハノイ・ロッテマート/", "clicks": 1557},
      {"url": "/blog/マレーシアの郵便番号/", "clicks": 1404},
      {"url": "/blog/ベトナムの郵便番号/", "clicks": 1294}
    ],
    "funnel_score": 12.5,
    "status": "危機的"
  }
}
```

---

### 4.3 転職コンテンツ充実度診断

#### 目的
キーワードリサーチで特定した転職キーワードに対し、コンテンツが存在するかを判定する。

#### 実行手順

1. **キーワードリサーチ資料.md から優先キーワードを抽出**
   - Tier 3（ロングテール）のキーワード一覧

2. **各キーワードに対応する記事の有無をチェック**
   - GSCクエリデータで順位を確認
   - 該当記事が存在するか確認

3. **カバレッジ算出**

```
カバレッジ = (記事が存在するキーワード数) / (優先キーワード総数) × 100
```

#### 出力

```json
{
  "content_coverage": {
    "priority_keywords_total": 25,
    "keywords_with_content": 8,
    "keywords_ranking_top10": 2,
    "coverage_rate": "32%",
    "missing_high_priority": [
      {"keyword": "タイ 仕事 日本人", "search_volume": 600, "status": "記事なし"},
      {"keyword": "海外転職 新卒", "search_volume": 350, "status": "記事なし"},
      {"keyword": "海外転職 50代", "search_volume": 300, "status": "記事なし"}
    ]
  }
}
```

---

### 4.4 技術SEO診断

#### 目的
検索エンジンがサイトを正しく評価できる状態かを判定する。

#### 実行手順

1. **構造化データ確認**
   - 求人ページにJobPosting Schemaが実装されているか
   - ブログ記事にArticle Schemaが実装されているか

2. **メタタグ確認**
   - トップページ、主要ページのtitle/descriptionを取得
   - 【実行用】メタディスクリプション最適化.md と比較

3. **インデックス状況確認**
   - `Googleインデックス登録ページ.csv` の総数
   - 求人ページのインデックス率

#### 出力

```json
{
  "technical_seo": {
    "structured_data": {
      "job_posting_implemented": false,
      "article_schema_implemented": "unknown",
      "organization_schema": "unknown"
    },
    "meta_tags": {
      "homepage_optimized": false,
      "job_pages_optimized": false
    },
    "indexing": {
      "total_indexed_pages": 500,
      "job_pages_indexed": 50,
      "blog_pages_indexed": 80
    },
    "status": "要改善"
  }
}
```

---

## 5. 総合診断と優先タスク生成

### 5.1 診断スコア算出

| 診断項目 | 重み | 算出方法 |
|---------|------|---------|
| トラフィック構造 | 30% | 転職関連クリック割合 |
| 導線・CTA | 30% | CTAカバレッジ率 |
| コンテンツ充実度 | 25% | キーワードカバレッジ率 |
| 技術SEO | 15% | 実装項目達成率 |

```
総合スコア = (各項目スコア × 重み) の合計
```

### 5.2 優先タスク自動生成ロジック

```
IF トラフィック構造.health_status == "危機的":
    優先タスク1 = "高トラフィック非転職記事へのCTA注入"
    優先度 = S
    理由 = "既存トラフィックをCVに転換する最短経路"

IF 導線診断.high_traffic_no_cta.length > 10:
    優先タスク2 = "上位10記事へのCTA・内部リンク追加"
    優先度 = S

IF 技術SEO.job_posting_implemented == false:
    優先タスク3 = "JobPosting Schema の実装"
    優先度 = A
    理由 = "Google しごと検索への表示"

IF コンテンツ充実度.coverage_rate < 50%:
    優先タスク4 = "不足キーワードの記事作成"
    優先度 = B
    理由 = "新規記事は導線整備後に実行"
```

---

## 6. 出力ファイル

診断完了後、以下のファイルを出力する：

### 6.1 診断レポート
**ファイル名**: `診断レポート_YYYY-MM-DD.md`

```markdown
# サイト診断レポート
## 診断日: YYYY-MM-DD

### サマリー
- 総合スコア: XX/100
- 総合判定: [良好 / 要改善 / 危機的]

### 1. トラフィック構造
[詳細]

### 2. 導線・CTA
[詳細]

### 3. コンテンツ充実度
[詳細]

### 4. 技術SEO
[詳細]

### 優先タスクリスト
1. [優先度S] ...
2. [優先度A] ...
3. [優先度B] ...
```

### 6.2 タスクJSON
**ファイル名**: `診断タスク_YYYY-MM-DD.json`

```json
{
  "generated_at": "2026-01-16T10:00:00Z",
  "tasks": [
    {
      "id": "T001",
      "title": "高トラフィック記事へのCTA注入",
      "priority": "S",
      "target_pages": [...],
      "action": "既存ページ最適化マニュアル参照"
    }
  ]
}
```

---

## 7. 安全ルール（厳守）

1. **診断は読み取り専用**
   - サイトへの変更は行わない
   - 結果はファイル出力のみ

2. **API呼び出し制限**
   - WordPress REST API: 1分あたり30リクエスト以内
   - 外部API（PageSpeed等）: 1日10回以内

3. **人間の承認**
   - 生成されたタスクの実行は人間の承認後

4. **データの保存**
   - GSCデータのローカルコピーは診断後も保持
   - 診断履歴は `診断履歴/` フォルダに蓄積

---

## 8. 次のアクション

診断完了後、優先度に応じて以下のマニュアルを実行：

| 優先度 | タスク種別 | 参照マニュアル |
|-------|-----------|---------------|
| S | CTA注入・内部リンク | 【実行用】既存ページ最適化マニュアル.md |
| A | 構造化データ実装 | 【実行用】構造化データコード.md |
| A | メタタグ最適化 | 【実行用】メタディスクリプション最適化.md |
| B | 新規記事作成 | 【実行用】AI完全自動化マニュアル.md |

---

*作成日: 2026年1月16日*
*バージョン: 1.0*
